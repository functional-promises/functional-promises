<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2.5">
    <title>Functional Promises - API Documentation</title>

    <style>
      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight .gh {
  color: #999999;
}
.highlight .sr {
  color: #f6aa11;
}
.highlight .go {
  color: #888888;
}
.highlight .gp {
  color: #555555;
}
.highlight .gs {
}
.highlight .gu {
  color: #aaaaaa;
}
.highlight .nb {
  color: #f6aa11;
}
.highlight .cm {
  color: #75715e;
}
.highlight .cp {
  color: #75715e;
}
.highlight .c1 {
  color: #75715e;
}
.highlight .cs {
  color: #75715e;
}
.highlight .c, .highlight .cd {
  color: #75715e;
}
.highlight .err {
  color: #960050;
}
.highlight .gr {
  color: #960050;
}
.highlight .gt {
  color: #960050;
}
.highlight .gd {
  color: #49483e;
}
.highlight .gi {
  color: #49483e;
}
.highlight .ge {
  color: #49483e;
}
.highlight .kc {
  color: #66d9ef;
}
.highlight .kd {
  color: #66d9ef;
}
.highlight .kr {
  color: #66d9ef;
}
.highlight .no {
  color: #66d9ef;
}
.highlight .kt {
  color: #66d9ef;
}
.highlight .mf {
  color: #ae81ff;
}
.highlight .mh {
  color: #ae81ff;
}
.highlight .il {
  color: #ae81ff;
}
.highlight .mi {
  color: #ae81ff;
}
.highlight .mo {
  color: #ae81ff;
}
.highlight .m, .highlight .mb, .highlight .mx {
  color: #ae81ff;
}
.highlight .sc {
  color: #ae81ff;
}
.highlight .se {
  color: #ae81ff;
}
.highlight .ss {
  color: #ae81ff;
}
.highlight .sd {
  color: #e6db74;
}
.highlight .s2 {
  color: #e6db74;
}
.highlight .sb {
  color: #e6db74;
}
.highlight .sh {
  color: #e6db74;
}
.highlight .si {
  color: #e6db74;
}
.highlight .sx {
  color: #e6db74;
}
.highlight .s1 {
  color: #e6db74;
}
.highlight .s {
  color: #e6db74;
}
.highlight .na {
  color: #a6e22e;
}
.highlight .nc {
  color: #a6e22e;
}
.highlight .nd {
  color: #a6e22e;
}
.highlight .ne {
  color: #a6e22e;
}
.highlight .nf {
  color: #a6e22e;
}
.highlight .vc {
  color: #ffffff;
}
.highlight .nn {
  color: #ffffff;
}
.highlight .nl {
  color: #ffffff;
}
.highlight .ni {
  color: #ffffff;
}
.highlight .bp {
  color: #ffffff;
}
.highlight .vg {
  color: #ffffff;
}
.highlight .vi {
  color: #ffffff;
}
.highlight .nv {
  color: #ffffff;
}
.highlight .w {
  color: #ffffff;
}
.highlight {
  color: #ffffff;
}
.highlight .n, .highlight .py, .highlight .nx {
  color: #ffffff;
}
.highlight .ow {
  color: #f92672;
}
.highlight .nt {
  color: #f92672;
}
.highlight .k, .highlight .kv {
  color: #f92672;
}
.highlight .kn {
  color: #f92672;
}
.highlight .kp {
  color: #f92672;
}
.highlight .o {
  color: #f92672;
}
    </style>
    <link href="stylesheets/screen.css" rel="stylesheet" media="screen" />
    <link href="stylesheets/print.css" rel="stylesheet" media="print" />
      <script src="javascripts/all.js"></script>
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-112472862-1"></script>

    <script src="https://embed.runkit.com"></script>
    <script src="javascripts/autorunkit.js"></script>

  </head>

  <body class="index" data-languages="[]">
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="images/navbar.png" alt="Navbar" />
      </span>
    </a>
    <div class="toc-wrapper">
      <a href="https://github.com/functional-promises/functional-promises" target="_blank"><img src="images/logo.png" class="logo" alt="Logo" /></a>
        <div class="search">
          <input type="text" class="search" id="input-search" placeholder="Search">
        </div>
        <ul class="search-results"></ul>
      <div id="toc" class="toc-list-h1">
          <li>
            <a href="#functional-promises" class="toc-h1 toc-link" data-title="Functional Promises">Functional Promises</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#summary" class="toc-h2 toc-link" data-title="Summary">Summary</a>
                  </li>
                  <li>
                    <a href="#library-comparison" class="toc-h2 toc-link" data-title="Library Comparison">Library Comparison</a>
                  </li>
                  <li>
                    <a href="#api-outline" class="toc-h2 toc-link" data-title="API Outline">API Outline</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#thenable-methods" class="toc-h1 toc-link" data-title="Thenable Methods">Thenable Methods</a>
          </li>
          <li>
            <a href="#array-methods" class="toc-h1 toc-link" data-title="<small>Â Â  Array Methods</small>"><small>Â Â  Array Methods</small></a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#fp-map" class="toc-h2 toc-link" data-title="<code>FP.map(iterable, fn)</code>"><code>FP.map(iterable, fn)</code></a>
                  </li>
                  <li>
                    <a href="#fp-filter" class="toc-h2 toc-link" data-title="<code>FP.filter(iterable, fn)</code>"><code>FP.filter(iterable, fn)</code></a>
                  </li>
                  <li>
                    <a href="#fp-find" class="toc-h2 toc-link" data-title="<code>FP.find(iterable, fn)</code>"><code>FP.find(iterable, fn)</code></a>
                  </li>
                  <li>
                    <a href="#fp-some" class="toc-h2 toc-link" data-title="<code>FP.some(iterable, fn)</code>"><code>FP.some(iterable, fn)</code></a>
                  </li>
                  <li>
                    <a href="#fp-none" class="toc-h2 toc-link" data-title="<code>FP.none(iterable, fn)</code>"><code>FP.none(iterable, fn)</code></a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#errors" class="toc-h1 toc-link" data-title="<small>Â Â  Errors</small>"><small>Â Â  Errors</small></a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#fp-catch" class="toc-h2 toc-link" data-title="<code>FP.catch(fn)</code>"><code>FP.catch(fn)</code></a>
                  </li>
                  <li>
                    <a href="#fp-catchif" class="toc-h2 toc-link" data-title="<code>FP.catchIf(type, fn)</code>"><code>FP.catchIf(type, fn)</code></a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#conditional" class="toc-h1 toc-link" data-title="<small>Â Â  Conditional</small>"><small>Â Â  Conditional</small></a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#fp-thenif" class="toc-h2 toc-link" data-title="<code>FP.thenIf()</code>"><code>FP.thenIf()</code></a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#utilities" class="toc-h1 toc-link" data-title="<small>Â Â  Utilities</small>"><small>Â Â  Utilities</small></a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#fp-tap" class="toc-h2 toc-link" data-title="<code>FP.tap(fn)</code>"><code>FP.tap(fn)</code></a>
                  </li>
                  <li>
                    <a href="#fp-delay" class="toc-h2 toc-link" data-title="<code>FP.delay(ms)</code>"><code>FP.delay(ms)</code></a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#properties" class="toc-h1 toc-link" data-title="<small>Â Â  Properties</small>"><small>Â Â  Properties</small></a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#fp-get" class="toc-h2 toc-link" data-title="<code>FP.get(keyName)</code>"><code>FP.get(keyName)</code></a>
                  </li>
                  <li>
                    <a href="#fp-set" class="toc-h2 toc-link" data-title="<code>FP.set(keyName, value)</code>"><code>FP.set(keyName, value)</code></a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#specialty-methods" class="toc-h1 toc-link" data-title="Specialty Methods">Specialty Methods</a>
          </li>
          <li>
            <a href="#helpers" class="toc-h1 toc-link" data-title="<small>Â Â  Helpers</small>"><small>Â Â  Helpers</small></a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#fp-promisify" class="toc-h2 toc-link" data-title="<code>FP.promisify(function)</code>"><code>FP.promisify(function)</code></a>
                  </li>
                  <li>
                    <a href="#fp-promisifyall" class="toc-h2 toc-link" data-title="<code>FP.promisifyAll()</code>"><code>FP.promisifyAll()</code></a>
                  </li>
                  <li>
                    <a href="#fp-resolve" class="toc-h2 toc-link" data-title="<code>FP.resolve(&lt;anything&gt;)</code>"><code>FP.resolve(&lt;anything&gt;)</code></a>
                  </li>
                  <li>
                    <a href="#fp-all" class="toc-h2 toc-link" data-title="<code>FP.all()</code>"><code>FP.all()</code></a>
                  </li>
                  <li>
                    <a href="#fp-unpack" class="toc-h2 toc-link" data-title="<code>FP.unpack()</code>"><code>FP.unpack()</code></a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#events" class="toc-h1 toc-link" data-title="<small>Â Â  Events</small>"><small>Â Â  Events</small></a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#fp-listen-event-helper" class="toc-h2 toc-link" data-title="<code>FP.listen()</code> event helper"><code>FP.listen()</code> event helper</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#composition-pipeline" class="toc-h1 toc-link" data-title="<small>Â Â  Composition Pipeline</small>"><small>Â Â  Composition Pipeline</small></a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#fp-chain-chainend" class="toc-h2 toc-link" data-title="<code>FP.chain() / .chainEnd()</code>"><code>FP.chain() / .chainEnd()</code></a>
                  </li>
                  <li>
                    <a href="#re-usable-promise-chains" class="toc-h2 toc-link" data-title="Re-usable Promise Chains">Re-usable Promise Chains</a>
                  </li>
                  <li>
                    <a href="#events-promise-chain" class="toc-h2 toc-link" data-title="Events + Promise Chain">Events + Promise Chain</a>
                  </li>
                  <li>
                    <a href="#controller-events-promise-chain" class="toc-h2 toc-link" data-title="Controller + Events + Promise Chain">Controller + Events + Promise Chain</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#modifiers" class="toc-h1 toc-link" data-title="<small>Â Â  Modifiers</small>"><small>Â Â  Modifiers</small></a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#fp-quiet" class="toc-h2 toc-link" data-title="<code>FP.quiet()</code>"><code>FP.quiet()</code></a>
                  </li>
                  <li>
                    <a href="#fp-concurrency" class="toc-h2 toc-link" data-title="<code>FP.concurrency(threadLimit)</code>"><code>FP.concurrency(threadLimit)</code></a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#misc" class="toc-h1 toc-link" data-title="Misc">Misc</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#detailed-stats" class="toc-h2 toc-link" data-title="Detailed Stats">Detailed Stats</a>
                  </li>
                  <li>
                    <a href="#feedback" class="toc-h2 toc-link" data-title="Feedback">Feedback</a>
                  </li>
              </ul>
          </li>
      </div>
        <ul class="toc-footer">
            <li><a class='social github' href='https://github.com/functional-promises/functional-promises'>Star on GitHub</a></li>
        </ul>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        <h1 id='functional-promises'>Functional Promises</h1><pre class="highlight sh tab-shell"><code><span class="c"># Install</span>
npm install functional-promises
</code></pre><pre class="highlight javascript tab-javascript"><code><span class="c1">//// Import into your app:</span>
<span class="kr">const</span> <span class="nx">FP</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'functional-promises'</span><span class="p">)</span>
<span class="c1">//  OR:</span>
<span class="kr">import</span> <span class="nx">FP</span> <span class="nx">from</span> <span class="s1">'functional-promises'</span>
</code></pre><h6 id='star-functional-promises-on-github'><a href="https://github.com/functional-promises/functional-promises">Star <code>Functional Promises</code> on Github</a></h6>
<blockquote>
<p style='text-align: center;'><strong style='font-size: 24px;'>Examples &amp; Awesome Shit</strong></p>

<p style='padding: 1.7em 28px;'>Array-style methods are built-in:</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code><span class="nx">FP</span><span class="p">.</span><span class="nx">resolve</span><span class="p">([</span><span class="s1">'1'</span><span class="p">,</span> <span class="s1">'2'</span><span class="p">,</span> <span class="s1">'3'</span><span class="p">,</span> <span class="s1">'4'</span><span class="p">,</span> <span class="s1">'5'</span><span class="p">])</span>
  <span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">x</span> <span class="o">=&gt;</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nx">x</span><span class="p">))</span>
  <span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="nx">x</span> <span class="o">=&gt;</span> <span class="nx">x</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">results</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">results</span><span class="p">)</span> <span class="c1">// [2, 4</span>
  <span class="p">})</span>
</code></pre>
<blockquote>
<p>Create re-usable sequences of functions with <code>.chain()</code>.</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code><span class="kr">const</span> <span class="nx">squareAndFormatDecimal</span> <span class="o">=</span> <span class="nx">FP</span>
  <span class="p">.</span><span class="nx">chain</span><span class="p">()</span>
  <span class="p">.</span><span class="nx">concurrency</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">x</span> <span class="o">=&gt;</span> <span class="nx">x</span> <span class="o">*</span> <span class="nx">x</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">concurrency</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">x</span> <span class="o">=&gt;</span> <span class="nb">parseFloat</span><span class="p">(</span><span class="nx">x</span><span class="p">).</span><span class="nx">toFixed</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
  <span class="p">.</span><span class="nx">chainEnd</span><span class="p">()</span> <span class="c1">// returns function</span>

<span class="nx">squareAndFormatDecimal</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">])</span>
  <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">num</span> <span class="o">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">num</span><span class="p">))</span> <span class="c1">// ['25.00', '100.00', '400.00']</span>
</code></pre>
<blockquote>
<p>Use <a href="https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API/Using_Fetch"><code>fetch</code></a> with <code>FP.thenIf()</code> to handle <code>response.ok === false</code> with custom response.</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code><span class="c1">//// Wrap `fetch()` with `FP.resolve()` to use `FP`'s methods</span>
<span class="nx">FP</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="nx">fetch</span><span class="p">(</span><span class="s1">'/profile'</span><span class="p">,</span> <span class="p">{</span><span class="na">method</span><span class="p">:</span> <span class="s1">'GET'</span><span class="p">}))</span>
  <span class="p">.</span><span class="nx">thenIf</span><span class="p">(</span> <span class="c1">// thenIf lets us handle branching logic</span>
    <span class="nx">res</span> <span class="o">=&gt;</span> <span class="nx">res</span><span class="p">.</span><span class="nx">ok</span><span class="p">,</span> <span class="c1">// Check if response is ok</span>
    <span class="nx">res</span> <span class="o">=&gt;</span> <span class="nx">res</span><span class="p">.</span><span class="nx">json</span><span class="p">(),</span> <span class="c1">// if true, return the parsed body</span>
    <span class="nx">res</span> <span class="o">=&gt;</span> <span class="p">({</span><span class="na">avatar</span><span class="p">:</span> <span class="s1">'/no-photo.svg'</span><span class="p">}))</span> <span class="c1">// fail, use default object</span>
  <span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">'avatar'</span><span class="p">)</span> <span class="c1">// Get the resulting objects `avatar` value</span>
  <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">avatarUrl</span> <span class="o">=&gt;</span> <span class="nx">imgElement</span><span class="p">.</span><span class="nx">src</span> <span class="o">=</span> <span class="nx">avatarUrl</span><span class="p">)</span>
</code></pre>
<p><a href="https://travis-ci.org/functional-promises/functional-promises"><img src="https://travis-ci.org/functional-promises/functional-promises.svg?branch=master" alt="Build Status" /></a>
<a href="https://github.com/functional-promises/functional-promises"><img src="https://img.shields.io/github/package-json/v/functional-promises/functional-promises.svg?style=flat" alt="GitHub package version" /></a>
<a href="https://github.com/functional-promises/functional-promises"><img src="https://img.shields.io/github/stars/functional-promises/functional-promises.svg?label=Stars&amp;style=flat" alt="GitHub stars" /></a></p>

<p><a href="https://www.npmjs.com/package/functional-promises"><img src="https://nodei.co/npm/functional-promises.png?downloads=true&amp;downloadRank=true&amp;stars=true" alt="NPM" /></a></p>

<aside class="success">
  Quotable
  <ul>
    <li> &quot;Small is beautiful.&quot; <a href='https://twitter.com/BrendanEich/status/957404602470510594' target='_blank'>Brendan Eich - co-inventor of JavaScript</a>
    <li> &quot;Duuuuude!&quot; <a href='https://github.com/sdras' target='_blank'>Sarah Drasner</a>
    <li> &quot;Nice, impressive!&quot; <a href='https://twitter.com/YDKJS' target='_blank'>Kyle Simpson</a>
  </ul>
</aside>
<h3 id='summary'>Summary</h3>
<p>The <strong>Functional Promises</strong> library is a Fluent <strong>Function Chaining Interface and Pattern.</strong></p>

<p><strong>Core features:</strong> Array Methods, Events, Array <strong>AND Object</strong> <code>FP.all()</code> Resolution, Re-usable Function Chains, Conditional/Branching Logic, Concurrency, Smart Error Handling.</p>

<p><code>FP</code> features seamless support between synchronous code, <code>async</code>/<code>await</code>, and native Promises. The core <i>Functional Composition</i> is powered by the <a href="#fp-chain"><code>FP.chain()</code></a> construct.</p>

<p><strong>Why not simply use [library X]?</strong></p>

<p><code>FP</code>&#39;s <strong>un-minified source</strong> is <strong>only ~370 lines</strong> of code.
The <strong>compressed+minified bundle</strong> weighs in at a humble <strong>~3Kb</strong>. The <strong>non-gzipped bundle</strong> weighs in around <strong>10Kb</strong> (using Webpack+Babel+Rollup+UglifyJS).</p>

<aside class="warning">
  Note: <code>functional-promises</code> is not a <code>Promise</code> replacement. It uses the native <code>Promise</code> API.
</aside>
<h3 id='library-comparison'>Library Comparison</h3>
<table><thead>
<tr>
<th>Library</th>
<th>Main deal</th>
<th style="text-align: right">Files</th>
<th style="text-align: right">Lines of Code</th>
<th style="text-align: right">.min.js kB</th>
</tr>
</thead><tbody>
<tr>
<td><strong>Functional Promise v1.8.0</strong></td>
<td>Sync &amp; Async Chains</td>
<td style="text-align: right">8</td>
<td style="text-align: right">376</td>
<td style="text-align: right">10 Kb / 3 Kb gzipped</td>
</tr>
<tr>
<td><a href="https://github.com/petkaantonov/bluebird">Bluebird</a> v3.5.1</td>
<td>Promises Replacement</td>
<td style="text-align: right">38</td>
<td style="text-align: right">5,188</td>
<td style="text-align: right">80 Kb</td>
</tr>
<tr>
<td><a href="https://github.com/ReactiveX/RxJS">RxJS</a> v5.5.6</td>
<td>Observables Chaining</td>
<td style="text-align: right">458</td>
<td style="text-align: right">12,266</td>
<td style="text-align: right">150 Kb</td>
</tr>
<tr>
<td><a href="https://github.com/ReactiveX/IxJS">IxJS</a> v2.3.4</td>
<td>[Async]Iterable Chaining</td>
<td style="text-align: right">521</td>
<td style="text-align: right">12,366</td>
<td style="text-align: right">145 Kb</td>
</tr>
</tbody></table>

<p><code>FP</code> is roughly <strong>1/30th</strong> the lines of code in <code>IxJs</code>. And it&#39;s bundle size is about <strong>1/9th</strong> the size! However <code>IxJS</code>/<code>RxJS</code> features a far larger API with 100&#39;s of methods.</p>

<p>BluebirdJS and FP have roughly the same number (and type) of API methods, yet <code>FP</code> is far less code.</p>

<p><b>To be clear:</b> Bluebird, RxJS and IxJS are amazing. Their patterns have been very influential on <code>FP</code>'s design.</p>

<p><small><p><b>Note:</b>&#160;<code>R/IxJS</code>&#39;s modular design also allows for bundle sizes to be smaller (using different syntax).</p></small></p>
<h3 id='api-outline'>API Outline</h3>
<p>All <code>.then()</code>-powered methods are listed first.</p>

<ul>
<li><a href="https://www.fpromises.io/#thenable-methods">Thenable Methods</a>

<ul>
<li><a href="https://www.fpromises.io/#array-methods">Arrays</a>

<ul>
<li><a href="https://www.fpromises.io/#fp-map"><code>.map(fn)</code></a></li>
<li><a href="https://www.fpromises.io/#fp-filter"><code>.filter(fn)</code></a></li>
<li><a href="https://www.fpromises.io/#fp-find"><code>.find(fn)</code></a></li>
<li><a href="https://www.fpromises.io/#fp-some"><code>.some(fn)</code></a></li>
<li><a href="https://www.fpromises.io/#fp-none"><code>.none(fn)</code></a></li>
<li><a href="https://www.fpromises.io/#fp-series"><code>.series(fn)</code></a></li>
</ul></li>
<li><a href="https://www.fpromises.io/#errors">Errors</a> <em>(WIP)</em>

<ul>
<li><a href="https://www.fpromises.io/#fp-catch"><code>.catch(fn)</code></a></li>
<li><a href="https://www.fpromises.io/#fp-catch"><code>.catchIf(filter, fn)</code></a></li>
</ul></li>
<li><a href="https://www.fpromises.io/#conditional">Conditional</a>

<ul>
<li><a href="https://www.fpromises.io/#fp-thenif"><code>.thenIf(fn, ifTrue, ifFalse)</code></a></li>
</ul></li>
<li><a href="https://www.fpromises.io/#utilities">Utilities</a>

<ul>
<li><a href="https://www.fpromises.io/#fp-tap"><code>.tap(fn)</code></a></li>
<li><a href="https://www.fpromises.io/#fp-delay"><code>.delay(msec)</code></a></li>
</ul></li>
<li><a href="https://www.fpromises.io/#properties">Properties</a>

<ul>
<li><a href="https://www.fpromises.io/#fp-get"><code>.get(keyName)</code></a></li>
<li><a href="https://www.fpromises.io/#fp-set"><code>.set(keyName, value)</code></a></li>
</ul></li>
</ul></li>
<li><a href="https://www.fpromises.io/#specialty-methods">Specialty Methods</a>

<ul>
<li><a href="https://www.fpromises.io/#helpers">Helpers</a>

<ul>
<li><a href="https://www.fpromises.io/#fp-promisify"><code>FP.promisify(callback)</code></a></li>
<li><a href="https://www.fpromises.io/#fp-promisifyall"><code>FP.promisifyAll(callback)</code></a></li>
<li><a href="https://www.fpromises.io/#fp-resolve"><code>FP.resolve()</code></a></li>
<li><a href="https://www.fpromises.io/#fp-all"><code>FP.all(Object/Array)</code></a></li>
<li><a href="https://www.fpromises.io/#fp-unpack"><code>FP.unpack()</code></a></li>
</ul></li>
<li><a href="https://www.fpromises.io/#events">Events</a>

<ul>
<li><a href="https://www.fpromises.io/#fp-listen"><code>.listen(obj, ...eventNames)</code></a></li>
</ul></li>
<li><a href="https://www.fpromises.io/#composition-pipeline">Composition Pipeline</a>

<ul>
<li><a href="https://www.fpromises.io/#fp-chain-chainend"><code>FP.chain(options)</code></a></li>
<li><a href="https://www.fpromises.io/#fp-chain-chainend"><code>.chainEnd()</code></a></li>
</ul></li>
<li><a href="https://www.fpromises.io/#modifiers">Modifiers</a>

<ul>
<li><a href="https://www.fpromises.io/#fp-quiet"><code>.quiet()</code> - prevents errors from stopping array methods mid-loop</a></li>
<li><a href="https://www.fpromises.io/#fp-concurrency"><code>.concurrency(threadLimit)</code> - limits parallel workers for array methods</a></li>
</ul></li>
</ul></li>
</ul>
<h1 id='thenable-methods'>Thenable Methods</h1>
<blockquote>
<p>A <code>.catch()</code> is another type of <code>thenable</code>! It works because an Error in a Promise will cause it to skip or &quot;surf&quot; over <code>thenables</code> until it finds a special <code>thenable</code>: <code>.catch()</code>. It then takes that Error value and passes it into the function. <code>.catch(err=&gt;{log(err.message)})</code></p>

<p><code>Thenable</code> methods in <code>FP</code> include: Arrays, Errors, Conditional, Utilities, Properties, etc.</p>
</blockquote>

<p>Most <code>FP</code> methods derive behavior from <strong>Native Promise&#39;s <code>.then()</code>.</strong></p>

<p>For example, <code>.tap(fn)</code>&#39;s function will receive the resolved value exactly like a <code>.then()</code>. Except the function&#39;s <code>return</code> value will be ignored - and the next <code>thenable</code> in the chain will get the original input.</p>

<aside class='success'>
  Click the Edit/Test link above code samples to run them live! <span style='font-size: 28px;'>ðŸ‘‰</span>
</aside>
<h1 id='array-methods'><small>&#160;&#160; Array Methods</small></h1><pre class="highlight javascript tab-javascript"><code><span class="kr">const</span> <span class="nx">rawData</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">99</span><span class="p">,</span> <span class="kc">null</span><span class="p">,</span> <span class="kc">undefined</span><span class="p">,</span> <span class="kc">NaN</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">'99'</span><span class="p">]</span>

<span class="c1">// Async compatible (not needed in this simple example)</span>
<span class="nx">FP</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="nx">rawData</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="nx">x</span> <span class="o">=&gt;</span> <span class="nx">x</span><span class="p">)</span>         <span class="c1">// truthiness check = [-99, "99"]</span>
  <span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">x</span> <span class="o">=&gt;</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nx">x</span><span class="p">))</span>  <span class="c1">// convert to numeric [-99 99]</span>
  <span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="nx">n</span> <span class="o">=&gt;</span> <span class="nx">n</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">)</span> <span class="c1">// is gte 1, idx = 1</span>
  <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">num</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">num</span><span class="p">)</span>    <span class="c1">// 99</span>
  <span class="p">})</span>
</code></pre>
<blockquote>
<p>Reuse functions, e.g. Native Array methods:</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code><span class="kr">const</span> <span class="nx">rawData</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">99</span><span class="p">,</span> <span class="kc">null</span><span class="p">,</span> <span class="kc">undefined</span><span class="p">,</span> <span class="kc">NaN</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">'99'</span><span class="p">]</span>

<span class="c1">// ... Compare w/ Native Array Method Usage:</span>
<span class="nx">rawData</span>
  <span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="nx">x</span> <span class="o">=&gt;</span> <span class="nx">x</span><span class="p">)</span>         <span class="c1">// truthiness check = [-99, "99"]</span>
  <span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">x</span> <span class="o">=&gt;</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nx">x</span><span class="p">))</span>  <span class="c1">// convert to numeric [-99, 99]</span>
  <span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="nx">n</span> <span class="o">=&gt;</span> <span class="nx">n</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">)</span>
</code></pre>
<p>Any <code>.then()</code> which would handle an array, may instead use one of the <code>FP</code> array methods.</p>

<ol>
<li>map</li>
<li>filter</li>
<li>find</li>
<li>some</li>
<li>none</li>
</ol>
<h2 id='fp-map'><code>FP.map(iterable, fn)</code></h2><pre class="highlight javascript tab-javascript"><code><span class="nx">FP</span><span class="p">.</span><span class="nx">resolve</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="c1">// Native es6 example: (Synchronous)</span>
<span class="c1">//.then(nums =&gt; nums.map(x =&gt; x * 2))</span>
  <span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">x</span> <span class="o">=&gt;</span> <span class="nx">x</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">results</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">results</span><span class="p">)</span> <span class="c1">// [2, 4, 6, 8, 10]</span>
  <span class="p">})</span>
</code></pre>
<p>Similar to <code>Array.prototype.map((item[, index, array]) =&gt; {})</code>.</p>

<p><strong>Use to transforms an array of values, passing each through the given function.</strong></p>

<p>The return value will be a new array containing the result for each call to <code>fn(item)</code>.</p>

<p>For example, let&#39;s say you have to multiply a list of numbers by 2.</p>

<p>Using <code>FP.map()</code> to do this lets you focus on the important logic: <code>x =&gt; x * 2</code></p>

<blockquote>
<p>Another neat trick w/ <code>FP</code> is auto-resolving nested Promises. Now you can ignore finickey details, like when AJAX data will be available.</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code><span class="kr">const</span> <span class="nx">dumbPromises</span> <span class="o">=</span> <span class="p">[</span><span class="nx">Promise</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="mi">25</span><span class="p">),</span> <span class="nx">Promise</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="mi">50</span><span class="p">)]</span>

<span class="nx">FP</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="nx">dumbPromises</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">concurrency</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">num</span> <span class="o">=&gt;</span> <span class="nx">FP</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="nx">num</span><span class="p">).</span><span class="nx">delay</span><span class="p">(</span><span class="nx">num</span><span class="p">))</span>
  <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">msec</span> <span class="o">=&gt;</span> <span class="s2">`Delayed </span><span class="p">${</span><span class="nx">msec</span><span class="p">}</span><span class="s2">`</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">results</span> <span class="o">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">results</span><span class="p">))</span>
</code></pre><h2 id='fp-filter'><code>FP.filter(iterable, fn)</code></h2><pre class="highlight javascript tab-javascript"><code><span class="nx">FP</span><span class="p">.</span><span class="nx">resolve</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="kc">null</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="kc">null</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
  <span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="nb">Boolean</span><span class="p">)</span>
<span class="c1">// Or similarly:</span>
<span class="c1">// .filter(value =&gt; value ? true : false)</span>
  <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">results</span> <span class="o">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">results</span><span class="p">))</span> <span class="c1">// [1, 3, 5]</span>
</code></pre>
<p>Use <code>.filter()</code> to omit items from the input array by passing through a given function. Items will be omitted if the function returns a falsey value.</p>

<aside class="notice">
  The <code>Boolean</code> type can be used as a truthiness check. For example: <code>assert.equal(Boolean(1), true)</code>, <code>assert.equal(Boolean(false), false)</code>, <code>assert.equal(Boolean(null), false)</code>.
</aside>
<h2 id='fp-find'><code>FP.find(iterable, fn)</code></h2><pre class="highlight javascript tab-javascript"><code><span class="nx">FP</span><span class="p">.</span><span class="nx">resolve</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
  <span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="nx">x</span> <span class="o">=&gt;</span> <span class="nx">x</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">results</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">results</span><span class="p">)</span> <span class="c1">// 2</span>
  <span class="p">})</span>
</code></pre>
<p>Returns first item to return truthy for <code>fn(item)</code></p>

<p>If no match is found it will return <code>undefined</code>.</p>
<h2 id='fp-some'><code>FP.some(iterable, fn)</code></h2><pre class="highlight javascript tab-javascript"><code><span class="nx">FP</span><span class="p">.</span><span class="nx">resolve</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
  <span class="p">.</span><span class="nx">some</span><span class="p">(</span><span class="nx">x</span> <span class="o">=&gt;</span> <span class="nx">x</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">results</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">results</span><span class="p">,</span> <span class="kc">true</span><span class="p">)</span>
  <span class="p">})</span>
</code></pre>
<p>Returns <code>Promise&lt;true&gt;</code> on the first <strong>item</strong> to return truthy for <code>fn(item)</code></p>

<p>If no truthy result is found, <code>.some()</code> returns <code>Promise&lt;false&gt;</code>.</p>
<h2 id='fp-none'><code>FP.none(iterable, fn)</code></h2><pre class="highlight javascript tab-javascript"><code><span class="nx">FP</span><span class="p">.</span><span class="nx">resolve</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
  <span class="p">.</span><span class="nx">none</span><span class="p">(</span><span class="nx">x</span> <span class="o">=&gt;</span> <span class="nx">x</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">results</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">results</span><span class="p">)</span> <span class="c1">// false</span>
  <span class="p">})</span>
</code></pre>
<p><code>.none()</code> resolves to <code>Promise&lt;false&gt;</code> on the first <strong>item</strong> to return falsey for <code>fn(item)</code></p>

<p>If no match is found it will return <code>Promise&lt;true&gt;</code>.</p>
<h1 id='errors'><small>&#160;&#160; Errors</small></h1><h2 id='fp-catch'><code>FP.catch(fn)</code></h2><h2 id='fp-catchif'><code>FP.catchIf(type, fn)</code></h2>
<blockquote>
<p>Catching errors by type</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code><span class="nx">FP</span><span class="p">.</span><span class="nx">resolve</span><span class="p">()</span>
  <span class="p">.</span><span class="nx">then</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="k">throw</span> <span class="k">new</span> <span class="nx">TypeError</span><span class="p">(</span><span class="s1">'Oh noes'</span><span class="p">)</span>
  <span class="p">})</span>
  <span class="p">.</span><span class="nx">then</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s1">'must skip this!'</span><span class="p">))</span>
  <span class="p">.</span><span class="k">catch</span><span class="p">(</span><span class="nx">ReferenceError</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s1">'arg too specific for .catch(type)'</span><span class="p">))</span>
  <span class="p">.</span><span class="k">catch</span><span class="p">(</span><span class="nx">SyntaxError</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s1">'arg too specific for .catch(type)'</span><span class="p">))</span>
  <span class="p">.</span><span class="k">catch</span><span class="p">(</span><span class="nx">TypeError</span><span class="p">,</span> <span class="nx">err</span> <span class="o">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">info</span><span class="p">(</span><span class="s1">'Success!!! filtered .catch(type)'</span><span class="p">,</span> <span class="nx">err</span><span class="p">))</span>
  <span class="p">.</span><span class="k">catch</span><span class="p">(</span><span class="nx">err</span> <span class="o">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s1">'Fallback, no error type matched'</span><span class="p">))</span>
</code></pre>
<p><code>.catch()</code> is analgous to native Promise error handling.</p>

<p>This example uses <code>TypeError</code> matching to print the &#39;success&#39; message - ignoring the other <code>catch</code>&#39;s.</p>
<h1 id='conditional'><small>&#160;&#160; Conditional</small></h1><h2 id='fp-thenif'><code>FP.thenIf()</code></h2>
<blockquote>
<p>Email &#39;validator&#39;</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code><span class="kd">let</span> <span class="nx">email</span> <span class="o">=</span> <span class="s1">'dan@danlevy.net'</span>
<span class="nx">FP</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="nx">email</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">thenIf</span><span class="p">(</span>
    <span class="nx">e</span> <span class="o">=&gt;</span> <span class="nx">e</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">5</span><span class="p">,</span> <span class="c1">// Conditional</span>
    <span class="nx">e</span> <span class="o">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'Valid: '</span><span class="p">,</span> <span class="nx">e</span><span class="p">),</span> <span class="c1">// ifTrue</span>
    <span class="nx">e</span> <span class="o">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s1">'Bad Email: '</span><span class="p">,</span> <span class="nx">e</span><span class="p">))</span> <span class="c1">// ifFalse</span>
</code></pre>
<p><code>.thenIf(condition(value), ifTrue(value), ifFalse(value))</code></p>
<h4 id='arguments'>Arguments</h4>
<blockquote>
<p>Functional Promise Login Flow</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code><span class="c1">//// Check if login successful, returning a token:</span>
<span class="kr">const</span> <span class="nx">authUser</span> <span class="o">=</span> <span class="p">(</span><span class="nx">email</span><span class="p">,</span> <span class="nx">pass</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">FP</span>
  <span class="p">.</span><span class="nx">resolve</span><span class="p">({</span><span class="nx">email</span><span class="p">,</span> <span class="nx">pass</span><span class="p">})</span>
  <span class="p">.</span><span class="nx">then</span><span class="p">(({</span><span class="nx">email</span><span class="p">,</span> <span class="nx">pass</span><span class="p">})</span> <span class="o">=&gt;</span> <span class="nx">svc</span><span class="p">.</span><span class="nx">loginGetUser</span><span class="p">(</span><span class="nx">email</span><span class="p">,</span> <span class="nx">pass</span><span class="p">))</span>
  <span class="p">.</span><span class="nx">thenIf</span><span class="p">(</span>
    <span class="nx">user</span> <span class="o">=&gt;</span> <span class="nx">user</span><span class="p">.</span><span class="nx">token</span><span class="p">,</span> <span class="c1">// is valid login</span>
    <span class="nx">user</span> <span class="o">=&gt;</span> <span class="nx">user</span><span class="p">,</span> <span class="c1">// return user to next .then function</span>
    <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span><span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s1">'Login Failed!'</span><span class="p">)}))</span>
</code></pre>
<ul>
<li><code>condition</code>, echo/truthy function: <code>(x) =&gt; x</code></li>
<li><code>ifTrue</code>, echo function: <code>(x) =&gt; x</code></li>
<li><code>ifFalse</code>, quiet function: <code>() =&gt; null</code></li>
</ul>

<p>The <code>condition</code> function should return either <code>true</code>/<code>false</code> or a promise that resolves to something <code>true</code>/<code>false</code>.</p>

<p><code>ifTrue</code> function is called if the <code>condition</code> resulted in a truthy value. Conversely, <code>ifFalse</code> will be called if we got a false answer.</p>

<p>The return value of either <code>ifTrue</code>/<code>ifFalse</code> handler will be handed to the next <code>.then()</code>.</p>

<p>Default values let you call <code>.thenIf</code> with no args - if you simply want to exclude falsey values down the chain.</p>
<h1 id='utilities'><small>&#160;&#160; Utilities</small></h1><h2 id='fp-tap'><code>FP.tap(fn)</code></h2><pre class="highlight javascript tab-javascript"><code><span class="nx">FP</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="nx">fetch</span><span class="p">(</span><span class="s1">'http://jsonplaceholder.typicode.com/photos/11'</span><span class="p">))</span>
  <span class="p">.</span><span class="nx">tap</span><span class="p">(</span><span class="nx">res</span> <span class="o">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">`ok:</span><span class="p">${</span><span class="nx">res</span><span class="p">.</span><span class="nx">ok</span><span class="p">}</span><span class="s2">`</span><span class="p">))</span>
  <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">res</span> <span class="o">=&gt;</span> <span class="nx">res</span><span class="p">.</span><span class="nx">json</span><span class="p">())</span>
  <span class="p">.</span><span class="nx">tap</span><span class="p">(</span><span class="nx">data</span> <span class="o">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'Keys: '</span> <span class="o">+</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">keys</span><span class="p">(</span><span class="nx">data</span><span class="p">).</span><span class="nx">sort</span><span class="p">().</span><span class="nx">join</span><span class="p">(</span><span class="s1">','</span><span class="p">)))</span>
  <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">data</span> <span class="o">=&gt;</span> <span class="s2">`&lt;img src='</span><span class="p">${</span><span class="nx">data</span><span class="p">.</span><span class="nx">url</span><span class="p">}</span><span class="s2">' alt='</span><span class="p">${</span><span class="nx">data</span><span class="p">.</span><span class="nx">title</span><span class="p">}</span><span class="s2">' /&gt;`</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">tap</span><span class="p">(</span><span class="nx">data</span> <span class="o">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'Image Url: '</span> <span class="o">+</span> <span class="nx">data</span><span class="p">.</span><span class="nx">url</span><span class="p">))</span>
</code></pre><pre class="highlight javascript tab-javascript"><code><span class="nx">FP</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="nx">fetch</span><span class="p">(</span><span class="s1">'https://api.github.com/users/justsml'</span><span class="p">))</span>
  <span class="p">.</span><span class="nx">tap</span><span class="p">(</span><span class="nx">res</span> <span class="o">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">`github user req ok? </span><span class="p">${</span><span class="nx">res</span><span class="p">.</span><span class="nx">ok</span><span class="p">}</span><span class="s2">`</span><span class="p">))</span>
  <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">res</span> <span class="o">=&gt;</span> <span class="nx">res</span><span class="p">.</span><span class="nx">json</span><span class="p">())</span>
  <span class="p">.</span><span class="nx">tap</span><span class="p">(</span><span class="nx">data</span> <span class="o">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'Keys:'</span><span class="p">,</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">keys</span><span class="p">(</span><span class="nx">data</span><span class="p">)))</span>
  <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">data</span> <span class="o">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">data</span><span class="p">))</span>
</code></pre>
<p>The <code>.tap()</code> method is <code>FP</code>&#39;s primary way to use the familiar <code>console.log()</code> - know it well.</p>

<p>It works just like <code>.then()</code> <strong>except it&#39;s return value is ignored.</strong> The next <code>thenable</code> will get the same input.</p>

<p>Perfect for logging or other background tasks (where results don&#39;t need to block).</p>
<h2 id='fp-delay'><code>FP.delay(ms)</code></h2>
<blockquote>
<p>Delay per-array item.</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code><span class="kr">const</span> <span class="nx">started</span> <span class="o">=</span> <span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">()</span>

<span class="nx">FP</span><span class="p">.</span><span class="nx">resolve</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
  <span class="p">.</span><span class="nx">concurrency</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
  <span class="c1">// now only 1 map() callback happens at a time</span>
  <span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">num</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">FP</span>
      <span class="p">.</span><span class="nx">delay</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
      <span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="nx">num</span><span class="p">)</span>
  <span class="p">})</span>
  <span class="p">.</span><span class="nx">then</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="kr">const</span> <span class="nx">runtime</span> <span class="o">=</span> <span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">()</span> <span class="o">-</span> <span class="nx">started</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">`Delayed </span><span class="p">${</span><span class="nx">runtime</span><span class="p">}</span><span class="s2">ms.`</span><span class="p">)</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">`Success: </span><span class="p">${</span><span class="nx">runtime</span> <span class="o">&gt;=</span> <span class="mi">200</span><span class="p">}</span><span class="s2">`</span><span class="p">)</span>
  <span class="p">})</span>
</code></pre>
<blockquote>
<p>Single delay added mid-sequence.</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code><span class="kr">const</span> <span class="nx">started</span> <span class="o">=</span> <span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">()</span>

<span class="nx">FP</span><span class="p">.</span><span class="nx">resolve</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
  <span class="p">.</span><span class="nx">delay</span><span class="p">(</span><span class="mi">250</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">num</span> <span class="o">=&gt;</span> <span class="nx">num</span> <span class="o">+</span> <span class="nx">num</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">then</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="kr">const</span> <span class="nx">runtime</span> <span class="o">=</span> <span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">()</span> <span class="o">-</span> <span class="nx">started</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">`Delayed </span><span class="p">${</span><span class="nx">runtime</span><span class="p">}</span><span class="s2">ms.`</span><span class="p">)</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">`Success: </span><span class="p">${</span><span class="nx">runtime</span> <span class="o">&gt;=</span> <span class="mi">250</span><span class="p">}</span><span class="s2">`</span><span class="p">)</span>
  <span class="p">})</span>
</code></pre>
<p><code>.delay(milliseconds)</code> is a helpful utility. It can help you avoid exceeding rate-limits in APIs. You can also use it to for simulated bottlenecks, adding &#39;slowdowns&#39; exactly where needed can greatly assist in locating many kinds of complex bugs.</p>
<h4 id='usage'>Usage</h4>
<ul>
<li>Shorthand with static helper: <code>.then(FP.delay(waitMs))</code></li>
<li>Nesting with static helper: FP.delay(waitMs): <code>.then(num =&gt; FP.delay(waitMs).then(() =&gt; num))</code></li>
<li>Using FP&#39;s instance method. <code>FP.resolve([1, 2, 3]).delay(250)</code></li>
</ul>
<h1 id='properties'><small>&#160;&#160; Properties</small></h1>
<p>These methods are particularly helpful for dealing with data extraction/transformation.</p>
<h2 id='fp-get'><code>FP.get(keyName)</code></h2><pre class="highlight javascript tab-javascript"><code><span class="nx">FP</span><span class="p">.</span><span class="nx">resolve</span><span class="p">({</span><span class="na">foo</span><span class="p">:</span> <span class="mi">42</span><span class="p">})</span>
  <span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">'foo'</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">x</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="c1">// x === 42</span>
  <span class="p">})</span>
</code></pre>
<p>Use to get a single key&#39;s value from an object.</p>

<p>Returns the key value.</p>
<h2 id='fp-set'><code>FP.set(keyName, value)</code></h2>
<blockquote>
<p>A common use-case includes dropping passwords or tokens.</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code><span class="nx">FP</span><span class="p">.</span><span class="nx">resolve</span><span class="p">({</span><span class="na">username</span><span class="p">:</span> <span class="s1">'dan'</span><span class="p">,</span> <span class="na">password</span><span class="p">:</span> <span class="s1">'sekret'</span><span class="p">})</span>
  <span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">'password'</span><span class="p">,</span> <span class="kc">undefined</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">obj</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">obj</span><span class="p">.</span><span class="nx">password</span><span class="p">)</span> <span class="c1">// obj.password === undefined</span>
  <span class="p">})</span>
</code></pre>
<p>Use to set a single key&#39;s value on an object.</p>

<p>Returns the <strong>modified object.</strong></p>
<h1 id='specialty-methods'>Specialty Methods</h1><h1 id='helpers'><small>&#160;&#160; Helpers</small></h1><h2 id='fp-promisify'><code>FP.promisify(function)</code></h2><pre class="highlight javascript"><code><span class="c1">//// fs - file system module</span>
<span class="kr">const</span> <span class="nx">fs</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'fs'</span><span class="p">)</span>
<span class="kr">const</span> <span class="nx">readFileAsync</span> <span class="o">=</span> <span class="nx">FP</span><span class="p">.</span><span class="nx">promisify</span><span class="p">(</span><span class="nx">fs</span><span class="p">.</span><span class="nx">readFile</span><span class="p">)</span>

<span class="nx">readFileAsync</span><span class="p">(</span><span class="s1">'/tmp/test.csv'</span><span class="p">,</span> <span class="s1">'utf8'</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">data</span> <span class="o">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">data</span><span class="p">))</span>

</code></pre>
<p>Utility to get a Promise-enabled version of any NodeJS-style callback function <code>(err, result)</code>.</p>
<h2 id='fp-promisifyall'><code>FP.promisifyAll()</code></h2><pre class="highlight javascript"><code><span class="c1">//// Common promisifyAll Examples:</span>

<span class="c1">// fs - node's file system module</span>
<span class="kr">const</span> <span class="nx">fs</span> <span class="o">=</span> <span class="nx">FP</span><span class="p">.</span><span class="nx">promisifyAll</span><span class="p">(</span><span class="nx">require</span><span class="p">(</span><span class="s1">'fs'</span><span class="p">))</span>
<span class="cm">/* USAGE:
fs.readFileAsync('/tmp/test.csv', 'utf8')
  .then(data =&gt; data.split('\n'))
  .map(line =&gt; line.split(','))
  .then(renderTable)
*/</span>

<span class="c1">// Redis</span>
<span class="kr">const</span> <span class="nx">redis</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'redis'</span><span class="p">)</span>
<span class="c1">// FP.promisifyAll(redis) // ðŸ’© wont work</span>
<span class="nx">FP</span><span class="p">.</span><span class="nx">promisifyAll</span><span class="p">(</span><span class="nx">redis</span><span class="p">.</span><span class="nx">RedisClient</span><span class="p">.</span><span class="nx">prototype</span><span class="p">)</span> <span class="c1">// ðŸ‘</span>
<span class="nx">FP</span><span class="p">.</span><span class="nx">promisifyAll</span><span class="p">(</span><span class="nx">redis</span><span class="p">.</span><span class="nx">Multi</span><span class="p">.</span><span class="nx">prototype</span><span class="p">)</span> <span class="c1">// ðŸ‘</span>
<span class="cm">/* USAGE:
client.getAsync('foo')
  .then(data =&gt; console.log('results', data)) */</span>

<span class="c1">// Mongodb (Note: use Monk, or Mongoose w/ native Promise support)</span>
<span class="kr">const</span> <span class="nx">MongoClient</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'mongodb'</span><span class="p">).</span><span class="nx">MongoClient</span><span class="p">;</span>
<span class="nx">FP</span><span class="p">.</span><span class="nx">promisifyAll</span><span class="p">(</span><span class="nx">MongoClient</span><span class="p">)</span>
<span class="cm">/* USAGE:
MongoClient.connectAsync('mongodb://localhost:27017')
  .then(db =&gt; db.collection('documents')) // get collection
  .then(FP.promisifyAll) // check to make sure we can use *Async methods
  .then(db =&gt; db.findAsync({})) // query w/ findAsync
  .catch(err =&gt; console.error('mongodb failed', err)) */</span>

<span class="c1">// mysql - Note: that mysql's classes are not properties of the main export</span>
<span class="c1">// Here's another way to `promisifyAll` prototypes directly</span>
<span class="nx">FP</span><span class="p">.</span><span class="nx">promisifyAll</span><span class="p">(</span><span class="nx">require</span><span class="p">(</span><span class="s1">'mysql/lib/Connection'</span><span class="p">).</span><span class="nx">prototype</span><span class="p">)</span>
<span class="nx">FP</span><span class="p">.</span><span class="nx">promisifyAll</span><span class="p">(</span><span class="nx">require</span><span class="p">(</span><span class="s1">'mysql/lib/Pool'</span><span class="p">).</span><span class="nx">prototype</span><span class="p">)</span>

<span class="c1">// pg - Note: postgres client is same as `node-postgres`</span>
<span class="c1">// - and pg supports promises natively now!</span>

<span class="c1">// Mongoose</span>
<span class="kr">const</span> <span class="nx">mongoose</span> <span class="o">=</span> <span class="nx">FP</span><span class="p">.</span><span class="nx">promisifyAll</span><span class="p">(</span><span class="nx">require</span><span class="p">(</span><span class="s1">'mongoose'</span><span class="p">))</span>
<span class="cm">/* USAGE:
mongoose.Promise = FP
model.findAsync({})
  .then(results =&gt; {...}) */</span>

<span class="c1">// Request</span>
<span class="nx">FP</span><span class="p">.</span><span class="nx">promisifyAll</span><span class="p">(</span><span class="nx">require</span><span class="p">(</span><span class="s1">'request'</span><span class="p">))</span>
<span class="cm">/* USAGE:
request.getAsync(url)
request.postAsync(url, data)
// requestAsync(..) // will not return a promise */</span>

<span class="c1">// rimraf - The module is a single function, use `FP.promisify`</span>
<span class="kr">const</span> <span class="nx">rimrafAsync</span> <span class="o">=</span> <span class="nx">Promise</span><span class="p">.</span><span class="nx">promisify</span><span class="p">(</span><span class="nx">require</span><span class="p">(</span><span class="s1">'rimraf'</span><span class="p">))</span>

<span class="c1">// Nodemailer</span>
<span class="nx">FP</span><span class="p">.</span><span class="nx">promisifyAll</span><span class="p">(</span><span class="nx">require</span><span class="p">(</span><span class="s1">'nodemailer'</span><span class="p">))</span>

<span class="c1">// xml2js</span>
<span class="nx">FP</span><span class="p">.</span><span class="nx">promisifyAll</span><span class="p">(</span><span class="nx">require</span><span class="p">(</span><span class="s1">'xml2js'</span><span class="p">))</span>
</code></pre>
<p><code>FP.promisifyAll(Object/Class/Prototype)</code> accepts an <code>Object/Class/Prototype-based-thing</code> and for every key of type <code>function</code> it adds a promisified version using the naming convention <code>obj.[functionName]Async()</code>.</p>

<p>Compared to <code>bluebird</code>, FP added a few tweaks to make it more versatile, specifically it works on any object - not limited to Classes and functions w/ a <code>prototype</code>.</p>

<blockquote>
<p><code>promisifyAll</code> is inspired by Bluebird&#39;s API.</p>
</blockquote>
<pre class="highlight javascript"><code><span class="c1">//// edge case:</span>
<span class="kr">const</span> <span class="nx">AwkwardLib</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">"..."</span><span class="p">)</span>
<span class="kr">const</span> <span class="nx">tmpInstance</span> <span class="o">=</span> <span class="nx">AwkwardLib</span><span class="p">.</span><span class="nx">createInstance</span><span class="p">()</span>
<span class="nx">FP</span><span class="p">.</span><span class="nx">promisifyAll</span><span class="p">(</span><span class="nb">Object</span><span class="p">.</span><span class="nx">getPrototypeOf</span><span class="p">(</span><span class="nx">tmpInstance</span><span class="p">))</span>
<span class="c1">// All new instances (incl tmpInstance) will feature .*Async() methods</span>
</code></pre>
<p>In all of the above cases the library made its classes available in one way or another. If this is not the case (factory functions, et al.), you can still promisify by creating a throwaway instance:</p>
<h2 id='fp-resolve'><code>FP.resolve(&lt;anything&gt;)</code></h2>
<blockquote>
<p>Promise anything like it&#39;s going out of style:</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code><span class="nx">FP</span><span class="p">.</span><span class="nx">resolve</span><span class="p">()</span>
<span class="nx">FP</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="nx">FP</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="nx">fetch</span><span class="p">(</span><span class="nx">url</span><span class="p">))</span>
<span class="nx">FP</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="nx">Promise</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="nx">anything</span><span class="p">))</span>
</code></pre>
<p>Turn anything into a <code>Functional Promise</code> wrapped promise!</p>

<p>Use to convert any Promise-like interface into an <code>FP</code>.</p>
<h2 id='fp-all'><code>FP.all()</code></h2><pre class="highlight javascript tab-javascript"><code><span class="nx">FP</span><span class="p">.</span><span class="nx">all</span><span class="p">([</span>
  <span class="nx">Promise</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>
  <span class="nx">Promise</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="p">])</span>
<span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">results</span> <span class="o">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">results</span><span class="p">))</span>

<span class="nx">FP</span><span class="p">.</span><span class="nx">all</span><span class="p">({</span>
  <span class="na">one</span><span class="p">:</span> <span class="nx">Promise</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>
  <span class="na">two</span><span class="p">:</span> <span class="nx">Promise</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="p">})</span>
<span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">results</span> <span class="o">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">results</span><span class="p">))</span>
</code></pre>
<p><code>FP.all()</code> provides an extended utility above the native <code>Promise.all()</code>, <strong>supporting both Objects and Arrays.</strong></p>

<p><em>Note:</em> Non-recursive.</p>
<h2 id='fp-unpack'><code>FP.unpack()</code></h2><pre class="highlight javascript tab-javascript"><code><span class="kd">function</span> <span class="nx">edgeCase</span><span class="p">()</span> <span class="p">{</span>
  <span class="kr">const</span> <span class="p">{</span> <span class="nx">promise</span><span class="p">,</span> <span class="nx">resolve</span><span class="p">,</span> <span class="nx">reject</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">FP</span><span class="p">.</span><span class="nx">unpack</span><span class="p">()</span>
  <span class="nx">setTimeout</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="nx">resolve</span><span class="p">(</span><span class="s1">'All done!'</span><span class="p">),</span> <span class="mi">1000</span><span class="p">)</span>
  <span class="k">return</span> <span class="nx">promise</span>
<span class="p">}</span>

<span class="nx">edgeCase</span><span class="p">()</span>
  <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">result</span> <span class="o">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">result</span><span class="p">))</span>
</code></pre>
<p>Use sparingly. Stream &amp; event handling are exempt from this &#39;rule&#39;. If using ES2015, destructuring helps to (more cleanly) achieve what <code>deferred</code> attempts.</p>

<p><code>deferred</code> is an anti-pattern because it doesn&#39;t align well with Functional Composition.</p>
<h1 id='events'><small>&#160;&#160; Events</small></h1><pre class="highlight javascript tab-javascript"><code><span class="c1">//// Example DOM code:</span>
<span class="kr">const</span> <span class="nx">button</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">'submitBtn'</span><span class="p">)</span>
<span class="nx">FP</span><span class="p">.</span><span class="nx">chain</span><span class="p">()</span>
  <span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">'target'</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">element</span> <span class="o">=&gt;</span> <span class="nx">element</span><span class="p">.</span><span class="nx">textContent</span> <span class="o">=</span> <span class="s1">'Clicked!'</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">listen</span><span class="p">(</span><span class="nx">button</span><span class="p">,</span> <span class="s1">'click'</span><span class="p">)</span>
</code></pre>
<aside class='warning'>
  Promises can be awkward when dealing with events.
</aside>

<aside class='success'>
  The <code>Functional Promise</code> library seeks a harmonious balance.
</aside>

<p>Key considerations:</p>

<p>Let&#39;s start with their <strong>similarity</strong>, both are (essentially) async...</p>

<p>And now for some <strong>differences</strong>:</p>

<ul>
<li>Promises are single-execution cached values. Memoized. Events can run many times per second with different arguments or data.</li>
<li>Events have control flow to think about (<code>e.preventDefault()</code>). Promises flow in one direction.</li>
<li>Promises depend on <code>return</code>&#39;s everywhere. Event handlers which <code>return</code> may cause unexpected control-flow issues.</li>
</ul>

<p><em>Yikes.</em></p>

<p>Let&#39;s look at some code &amp; see how <code>FP</code> improves the situation:</p>
<h2 id='fp-listen-event-helper'><code>FP.listen()</code> event helper</h2><pre class="highlight javascript tab-javascript"><code><span class="nx">FP</span><span class="p">.</span><span class="nx">chain</span><span class="p">()</span>
  <span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">'target'</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">'textContent'</span><span class="p">,</span> <span class="s1">'Clicked!'</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">listen</span><span class="p">(</span><span class="nx">button</span><span class="p">,</span> <span class="s1">'click'</span><span class="p">)</span>
</code></pre>
<p>The <code>.listen()</code> method must be called after an <code>FP.chain()</code> sequence of <code>FP</code> methods.</p>

<p><strong>Note:</strong> The <code>.chainEnd()</code> method is automatically called.</p>
<h1 id='composition-pipeline'><small>&#160;&#160; Composition Pipeline</small></h1>
<p>Composition Pipelines is a combination of ideas from <a href="https://martinfowler.com/articles/collection-pipeline/"><code>Collection</code> Pipeline</a> and <a href="https://medium.com/javascript-scene/composing-software-an-introduction-27b72500d6ea">Functional Composition</a>.</p>

<aside class="notice">
  <i>Forgive me Haskell people, but I'm calling this a monad builder.</i> Just <code>do</code> it! I mean work with me here.
</aside>

<p>Chained Functional Promises unlock a powerful technique: <strong>Reusable Async Composition Pipeline.</strong></p>

<p><strong>Enough jargon!</strong> <em>Let&#39;s create some slick JavaScript:</em></p>

<!-- **Examples and usage patterns below:** -->
<h2 id='fp-chain-chainend'><code>FP.chain() / .chainEnd()</code></h2>
<p>The method <code>FP.chain()</code> starts &#39;recording&#39; your functional chain.</p>

<p>All chain-based features (<code>FP.listen(el, ...events)</code>, <code>FP.run(opts)</code>, et. al.) use <code>.chainEnd()</code> to get a function to &#39;replay&#39; the methods after <code>.chain()</code>.</p>

<p>Whether directly or indirectly <code>.chainEnd()</code> must be called.</p>
<pre class="highlight javascript tab-javascript"><code><span class="kr">const</span> <span class="nx">getTarget</span> <span class="o">=</span> <span class="nx">FP</span>
  <span class="p">.</span><span class="nx">chain</span><span class="p">()</span>
  <span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">'target'</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">chainEnd</span><span class="p">()</span>

<span class="kr">const</span> <span class="nx">handler</span> <span class="o">=</span> <span class="nx">event</span> <span class="o">=&gt;</span> <span class="nx">getTarget</span><span class="p">(</span><span class="nx">event</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">target</span> <span class="o">=&gt;</span> <span class="p">{</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'Event target: '</span><span class="p">,</span> <span class="nx">target</span><span class="p">)})</span>
</code></pre>
<p><code>FP.chain()</code> is a static method on <code>FP</code>.</p>
<h2 id='re-usable-promise-chains'>Re-usable Promise Chains</h2><pre class="highlight javascript tab-javascript"><code><span class="kr">const</span> <span class="nx">squareAndFormatDecimal</span> <span class="o">=</span> <span class="nx">FP</span>
  <span class="p">.</span><span class="nx">chain</span><span class="p">()</span>
  <span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">x</span> <span class="o">=&gt;</span> <span class="nx">x</span> <span class="o">*</span> <span class="nx">x</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">x</span> <span class="o">=&gt;</span> <span class="nb">parseFloat</span><span class="p">(</span><span class="nx">x</span><span class="p">).</span><span class="nx">toFixed</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
  <span class="p">.</span><span class="nx">chainEnd</span><span class="p">()</span>

<span class="nx">squareAndFormatDecimal</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">])</span>
  <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">num</span> <span class="o">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">num</span><span class="p">))</span> <span class="c1">// ['25.00', '36.00']</span>
</code></pre>
<p><strong>HOW TO:</strong> Create a re-usable chain with 2 <code>.map</code> steps:</p>

<ol>
<li>Create a chain, name it <code>squareAndFormatDecimal</code>.</li>
<li>When <code>squareAndFormatDecimal(nums)</code> is passed an <code>Array&lt;Number&gt;</code> it must:

<ol>
<li>Square each number.</li>
<li>Convert each number to a decimal, then format with <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number/toFixed"><code>float.toFixed(2)</code></a>.</li>
</ol></li>
<li>Execute named function <code>squareAndFormatDecimal</code> with array <code>[5, 6]</code>.</li>
</ol>
<h2 id='events-promise-chain'>Events + Promise Chain</h2><pre class="highlight javascript tab-javascript"><code><span class="c1">//// Example DOM Code</span>
<span class="kr">const</span> <span class="nx">form</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s1">'form'</span><span class="p">)</span>
<span class="kr">const</span> <span class="nx">submitHandler</span> <span class="o">=</span> <span class="nx">createTodoHandler</span><span class="p">()</span>
<span class="nx">form</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">'submit'</span><span class="p">,</span> <span class="nx">submitHandler</span><span class="p">)</span>

<span class="kd">function</span> <span class="nx">createTodoHandler</span><span class="p">()</span> <span class="p">{</span>
  <span class="kr">const</span> <span class="nx">statusLbl</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s1">'label.status'</span><span class="p">)</span>
  <span class="kr">const</span> <span class="nx">setStatus</span> <span class="o">=</span> <span class="nx">s</span> <span class="o">=&gt;</span> <span class="nx">statusLbl</span><span class="p">.</span><span class="nx">textContent</span> <span class="o">=</span> <span class="nx">s</span>
  <span class="kr">const</span> <span class="nx">setError</span>  <span class="o">=</span> <span class="nx">err</span> <span class="o">=&gt;</span> <span class="nx">setStatus</span><span class="p">(</span><span class="s2">`ERROR: </span><span class="p">${</span><span class="nx">err</span><span class="p">}</span><span class="s2">`</span><span class="p">)</span>

  <span class="k">return</span> <span class="nx">FP</span>
    <span class="p">.</span><span class="nx">chain</span><span class="p">()</span> <span class="c1">// input arg will get 'passed' in here</span>
    <span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">'target'</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">form</span> <span class="o">=&gt;</span> <span class="nx">form</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s1">'input.todo-text'</span><span class="p">).</span><span class="nx">value</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">todoText</span> <span class="o">=&gt;</span> <span class="p">({</span><span class="na">id</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span> <span class="na">complete</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span> <span class="na">text</span><span class="p">:</span> <span class="nx">todoText</span><span class="p">}))</span>
    <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">todoAPI</span><span class="p">.</span><span class="nx">create</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">tap</span><span class="p">(</span><span class="nx">createResult</span> <span class="o">=&gt;</span> <span class="nx">setStatus</span><span class="p">(</span><span class="nx">createResult</span><span class="p">.</span><span class="nx">message</span><span class="p">))</span>
    <span class="p">.</span><span class="k">catch</span><span class="p">(</span><span class="nx">setError</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">chainEnd</span><span class="p">()</span>
<span class="p">}</span>
</code></pre>
<p>The method <code>createTodoHandler()</code> gives you a Functional chain to:</p>

<ol>
<li>Define single-arg helper methods <code>setStatus()</code> &amp; <code>setError()</code></li>
<li>Start chain expression</li>
<li>Get element using <code>.get()</code> to extract <code>target</code> property (which will be a <code>&lt;form&gt;&lt;/form&gt;</code>)</li>
<li>Get value from contained <code>input.todo-text</code> element</li>
<li>Put todo&#39;s text into a JS Object shaped for service endpoint</li>
<li>Pass data along to <code>todoAPI.create()</code> method</li>
<li>Update UI with <code>setStatus()</code></li>
<li>Handle any errors w/ <code>setError()</code></li>
</ol>
<h2 id='controller-events-promise-chain'>Controller + Events + Promise Chain</h2>
<blockquote>
<p>Usage Example: (see Class implementation below)</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code><span class="c1">//// usage example - standard promise code:</span>
<span class="kr">const</span> <span class="nx">todoApp</span> <span class="o">=</span> <span class="nx">TodoApp</span><span class="p">()</span>

<span class="nx">todoApp</span><span class="p">.</span><span class="nx">update</span><span class="p">({</span><span class="na">id</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="na">text</span><span class="p">:</span> <span class="s1">'updated item'</span><span class="p">,</span> <span class="na">complete</span><span class="p">:</span> <span class="kc">true</span><span class="p">})</span>
  <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">console</span><span class="p">.</span><span class="nx">warn</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="nx">console</span><span class="p">,</span> <span class="s1">'update response:'</span><span class="p">))</span>

<span class="nx">todoApp</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="s1">'new item'</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">result</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'Added item'</span><span class="p">,</span> <span class="nx">result</span><span class="p">)</span>
  <span class="p">})</span>
</code></pre>
<blockquote>
<p>TodoApp will return an object with <code>add</code> and <code>update</code> methods - based on FP.chain()</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code><span class="c1">//// example code:</span>
<span class="kd">function</span> <span class="nx">TodoApp</span><span class="p">()</span> <span class="p">{</span>
  <span class="kr">const</span> <span class="nx">statusLbl</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s1">'label.status'</span><span class="p">)</span>
  <span class="kr">const</span> <span class="nx">setStatus</span> <span class="o">=</span> <span class="nx">s</span> <span class="o">=&gt;</span> <span class="nx">statusLbl</span><span class="p">.</span><span class="nx">textContent</span> <span class="o">=</span> <span class="nx">s</span>

  <span class="k">return</span> <span class="p">{</span>
    <span class="na">add</span><span class="p">:</span> <span class="nx">FP</span><span class="p">.</span><span class="nx">chain</span><span class="p">()</span>
      <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">input</span> <span class="o">=&gt;</span> <span class="p">({</span><span class="na">text</span><span class="p">:</span> <span class="nx">input</span><span class="p">,</span> <span class="na">complete</span><span class="p">:</span> <span class="kc">false</span><span class="p">}))</span>
      <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">todoAPI</span><span class="p">.</span><span class="nx">create</span><span class="p">)</span>
      <span class="p">.</span><span class="nx">tap</span><span class="p">(</span><span class="nx">createResult</span> <span class="o">=&gt;</span> <span class="nx">setStatus</span><span class="p">(</span><span class="nx">createResult</span><span class="p">.</span><span class="nx">message</span><span class="p">))</span>
      <span class="p">.</span><span class="nx">chainEnd</span><span class="p">(),</span>

    <span class="na">update</span><span class="p">:</span> <span class="nx">FP</span><span class="p">.</span><span class="nx">chain</span><span class="p">()</span>
      <span class="c1">// in v1.5.0: .get('id', 'completed', 'text') // or:</span>
      <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">input</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="kr">const</span> <span class="p">{</span><span class="nx">id</span><span class="p">,</span> <span class="nx">complete</span><span class="p">,</span> <span class="nx">text</span><span class="p">}</span> <span class="o">=</span> <span class="nx">input</span>
        <span class="k">return</span> <span class="p">{</span><span class="nx">id</span><span class="p">,</span> <span class="nx">complete</span><span class="p">,</span> <span class="nx">text</span><span class="p">}</span>
      <span class="p">})</span>
      <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">todoAPI</span><span class="p">.</span><span class="nx">update</span><span class="p">)</span>
      <span class="p">.</span><span class="nx">tap</span><span class="p">(</span><span class="nx">updateResult</span> <span class="o">=&gt;</span> <span class="nx">setStatus</span><span class="p">(</span><span class="nx">updateResult</span><span class="p">.</span><span class="nx">message</span><span class="p">))</span>
      <span class="p">.</span><span class="nx">chainEnd</span><span class="p">()</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre>
<p>Example OOP style &#39;class&#39; object/interface.</p>

<p>Here we implement the interface <code>{ add(item), update(item) }</code> <strong>using chained function expressions</strong>. It&#39;s implementation is hidden from the calling code.</p>

<aside class="notice">
  <code>FP.chain()</code> is a powerful building block. Use with: events, streams, Observables (RxJS), AsyncIterables (IxJS), <code>for</code> loops, and basically anything that takes a function.
  <br/>
  <b>It returns a re-usable function, built out of a sequence of smaller functions.</b>
</aside>

<p>This is a key differentiator between <code>functional-promises</code> and other chaining libraries. No lockin.</p>
<h1 id='modifiers'><small>&#160;&#160; Modifiers</small></h1><h2 id='fp-quiet'><code>FP.quiet()</code></h2><pre class="highlight javascript tab-javascript"><code><span class="nx">FP</span><span class="p">.</span><span class="nx">resolve</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
  <span class="p">.</span><span class="nx">quiet</span><span class="p">()</span>
  <span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">x</span> <span class="o">=&gt;</span> <span class="mi">2</span> <span class="o">/</span> <span class="nx">x</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">results</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">results</span><span class="p">)</span> <span class="c1">// [1, 2, Error])</span>
  <span class="p">})</span>
</code></pre>
<p>Suppresses errors by converting them to return values.</p>

<p><strong>Only applies to subsequent Array thenables.</strong></p>
<h2 id='fp-concurrency'><code>FP.concurrency(threadLimit)</code></h2><pre class="highlight javascript tab-javascript"><code><span class="nx">FP</span><span class="p">.</span><span class="nx">resolve</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
  <span class="p">.</span><span class="nx">concurrency</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">x</span> <span class="o">=&gt;</span> <span class="nx">x</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">results</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">results</span><span class="p">)</span><span class="c1">// [2, 4, 6, 8, 10]</span>
  <span class="p">})</span>
</code></pre>
<p>Set <code>threadLimit</code> to constrain the amount of simultaneous tasks/promises can run.</p>

<p><strong>Only applies to subsequent thenable Array methods.</strong></p>

<blockquote>
<p>Thanks to several influencial projects: RxJS, IxJS, Bluebird, asynquence, FantasyLand, Gulp, HighlandJS, et al.</p>
</blockquote>

<blockquote style='text-align: right;'><p>
  <br />
  <a class='bottom' target='_blank' href='https://github.com/lord/slate'>Docs Powered by Slate</a>
</p></blockquote>
<h1 id='misc'>Misc</h1><h2 id='detailed-stats'>Detailed Stats</h2><h5 id='functional-promise-min-js-compression-results'><code>./functional-promise.min.js</code> Compression Results</h5>
<table><thead>
<tr>
<th>Utility</th>
<th>File Size</th>
</tr>
</thead><tbody>
<tr>
<td><em>original</em></td>
<td>17K</td>
</tr>
<tr>
<td>gzip</td>
<td>4.5K  (3.69 X smaller)</td>
</tr>
<tr>
<td>brotli</td>
<td>4.0K  (4.13 X smaller)</td>
</tr>
</tbody></table>
<h5 id='rx-min-js-compression-results'><code>./Rx.min.js</code> Compression Results</h5>
<table><thead>
<tr>
<th>Utility</th>
<th>File Size</th>
</tr>
</thead><tbody>
<tr>
<td><em>original</em></td>
<td>146K</td>
</tr>
<tr>
<td>gzip</td>
<td>32K  (4.68 X smaller)</td>
</tr>
<tr>
<td>brotli</td>
<td>27K  (5.47 X smaller)</td>
</tr>
</tbody></table>
<h5 id='ix-min-js-compression-results'><code>./Ix.min.js</code> Compression Results</h5>
<table><thead>
<tr>
<th>Utility</th>
<th>File Size</th>
</tr>
</thead><tbody>
<tr>
<td><em>original</em></td>
<td>129K</td>
</tr>
<tr>
<td>gzip</td>
<td>22K  (6.01 X smaller)</td>
</tr>
<tr>
<td>brotli</td>
<td>17K  (7.92 X smaller)</td>
</tr>
</tbody></table>
<h2 id='feedback'>Feedback</h2><h4 id='and-other-kind-words'>and other kind words</h4>
<ul>
<li>&quot;Small is beautiful.&quot; - <a href="https://twitter.com/BrendanEich/status/957404602470510594">Brendan Eich - co-inventor of JavaScript</a></li>
<li>&quot;Duuuuude!&quot; - <a href="https://github.com/sdras">Sarah Drasner</a></li>
<li>&quot;nice, impressive!&quot; - <a href="https://twitter.com/YDKJS">Kyle Simpson</a></li>
<li>&quot;This is really cool. Well done Dan&quot; - <a href="https://twitter.com/jamonholmgren/status/957382985107456000">Jamon Holmgren</a></li>
<li>&quot;quick first impression: they look amazing&quot; - <a href="https://twitter.com/brianleroux">Brian Leroux</a></li>
<li>&quot;Oh wow, really like that interface!&quot; - <a href="https://github.com/lord/slate/pull/946#issuecomment-361167298">Robert Lord</a></li>
<li>&quot;That&#39;s so damn cool!!&quot; - <a href="https://twitter.com/alfiedotwtf">Alfie John</a></li>
<li>&quot;... At a quick glance this looks lovely. Blows my mind it can be so small.&quot; - <a href="https://twitter.com/skellock/status/957399605863317509">Steve Kellock</a></li>
</ul>
<h4 id='thank-you-all-for-the-support-amp-encouragement'>Thank you all for the support &amp; encouragement!</h4><h4 id='javascript-community-is-the-best'>JavaScript community is the best!</h4>
      </div>
      <div class="dark-box">
      </div>
    </div>

    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-112472862-1');
    </script>

    <script>
      window.addEventListener('hashchange', function(event) {
        var hash = self.location.hash;
        hash = !hash ? 'top' : hash.slice(1);
        if (hash && hash.length >= 1) {
          gtag('event', 'screen_view', {
            'app_name': 'fpromises',
            'screen_name': hash
          });
        }
      });
    </script>
  </body>
</html>
